<div class="min-h-screen bg-gradient-to-br from-gray-100 to-blue-100">
  <!-- Header -->
  <header class="bg-white shadow">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
      <h1 class="text-3xl font-bold text-blue-700">API Generator</h1>
      <button
        (click)="logout()"
        class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition"
      >
        Logout
      </button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Breadcrumb -->
    <div class="mb-6">
      <a routerLink="/collections" class="text-blue-600 hover:underline">‚Üê Back to Collections</a>
    </div>

    <!-- Error Message -->
    <div *ngIf="error" class="mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded">
      {{ error }}
    </div>

    <!-- Header with Create Button -->
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-semibold text-gray-800">Documents in "{{ collectionName }}"</h2>
      <a
        [routerLink]="['/collections', collectionName, 'documents', 'create']"
        class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition"
      >
        + Create Document
      </a>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="text-center py-12">
      <p class="text-gray-600">Loading documents...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && documents.length === 0" class="text-center py-12">
      <p class="text-gray-600 mb-4">No documents yet. Create your first document!</p>
      <a
        [routerLink]="['/collections', collectionName, 'documents', 'create']"
        class="inline-block px-6 py-3 bg-blue-600 text-white rounded hover:bg-blue-700 transition"
      >
        Create Document
      </a>
    </div>

    <!-- Documents List -->
    <div *ngIf="!loading && documents.length > 0" class="space-y-4">
      <div
        *ngFor="let document of documents"
        class="bg-white rounded-lg shadow hover:shadow-lg transition p-6"
      >
        <div class="flex justify-between items-start mb-4">
          <div class="flex-1">
            <h3 class="text-lg font-semibold text-gray-800 mb-2">Document #{{ document.id }}</h3>
            <div class="text-sm text-gray-600 space-y-1">
              <p><strong>Created:</strong> {{ document.createdAt | date:'short' }}</p>
            </div>
          </div>
          <div class="flex gap-2">
            <a
              [routerLink]="['/collections', collectionName, 'documents', document.id, 'edit']"
              class="px-3 py-1 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition text-sm"
            >
              Edit
            </a>
            <button
              (click)="deleteDocument(document.id)"
              class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition text-sm"
            >
              Delete
            </button>
          </div>
        </div>

        <!-- Document Data Section -->
        <div class="mt-4">
          <div class="flex justify-between items-center mb-2">
            <h4 class="text-sm font-semibold text-gray-700">Data:</h4>
            <button
              (click)="toggleJsonView(document.id)"
              class="px-3 py-1 text-xs font-medium rounded transition"
              [ngClass]="isJsonVisible(document.id) ? 'bg-blue-100 text-blue-700 hover:bg-blue-200' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'"
            >
              {{ isJsonVisible(document.id) ? 'üëÅÔ∏è Hide JSON' : 'üëÅÔ∏è Show JSON' }}
            </button>
          </div>

          <!-- JSON View -->
          <div *ngIf="isJsonVisible(document.id)" class="animate-fadeIn">
            <pre
              class="p-4 bg-gray-900 rounded text-sm overflow-x-auto border border-gray-700 shadow-inner font-mono"
              [innerHTML]="getColoredJson(document.data)"
            ></pre>
          </div>

          <!-- Compact Summary when collapsed -->
          <div *ngIf="!isJsonVisible(document.id)" class="p-3 bg-gray-50 rounded border border-gray-200">
            <p class="text-sm text-gray-600">
              {{ getDocumentKeys(document.data).length }} field{{ getDocumentKeys(document.data).length !== 1 ? 's' : '' }}
              <span class="text-gray-400">‚Äî</span>
              <span class="text-xs text-gray-500">Click "Show JSON" to view details</span>
            </p>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
